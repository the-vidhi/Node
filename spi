#include <SPI.h>

int ldr;
byte c = 0, b=0;
volatile byte pos;
volatile boolean processing;
byte i;

void setup (void)
{
  Serial.begin (115200);
  pinMode(MISO, OUTPUT);
  pinMode(MOSI, INPUT);
  SPCR |= _BV(SPE);
  pos = 0;
  processing = false;
  SPI.attachInterrupt();
}


void loop (void)
{
  ldr = analogRead(A0);
  SPDR=ldr;
 
}

import spidev
import sqlite3
import datetime
import time

connection = sqlite3.connect("spi.db")

crsr = connection.cursor()
sql_createtbl = """create table if not exists spidata(light VARCHAR(50),datetime DATE);"""
crsr.execute(sql_createtbl)

spi=spidev.SpiDev(0,0)
spi.open(0,0)
#msg= 0xAA
spi.max_speed_hz = 115200
#while 1:
 #   spi.writebytes([0x4,0x06])
    #resp=spi.xfer2(0xAA)
while(1):
    y = spi.readbytes(1)
    print (y)
    
    crsr.execute("INSERT INTO spidata(light,datetime) VALUES(?,?)",(str(y),str(datetime.datetime.now())))

    #crsr.execute("INSERT INTO DATA2(light) VALUES(?)",(2))
    time.sleep(2)  
    crsr.execute("select * from spidata")
    ans = crsr.fetchall()

    print(ans)
    time.sleep(0.5)
